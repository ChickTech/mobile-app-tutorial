

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Networking &mdash; Mobile App Tutorial 0.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/tutorial.css" type="text/css" />
  

  
    <link rel="top" title="Mobile App Tutorial 0.1 documentation" href="../index.html"/>
        <link rel="next" title="Location" href="../location/index.html"/>
        <link rel="prev" title="QR Code" href="../qr-code/index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Mobile App Tutorial
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../requirements/index.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../emulator-installation/index.html">Emulator Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../the-basics/index.html">The Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../camera/index.html">Camera</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/index.html">Math</a></li>
<li class="toctree-l1"><a class="reference internal" href="../canvas/index.html">Canvas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../qr-code/index.html">QR Code</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Networking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../location/index.html">Location</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/index.html">Appendix</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Mobile App Tutorial</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li>Networking</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/networking/index.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="networking">
<h1>Networking<a class="headerlink" href="#networking" title="Permalink to this headline">¶</a></h1>
<p>Imagine, for a moment, that you are an app inventor living in Butterton,
IL. Your friend and neighbor, Tracy, had a cat named Space Cat who left
just the other day. It turns out that Space Cat was really a space alien
who was here to study humans, but she got homesick so she decided to
return to her home planet. Despite her abrupt departure, Space Cat
really did enjoy her time with Tracy, and left her a farewell present in
the form of an .aia file. Tracy doesn't know much about App Inventor, so
she asks you to take a look.</p>
<p>Download <a class="reference download internal" href="../_downloads/FarewellTracy.aia"><code class="xref download docutils literal"><span class="pre">FarewellTracy.aia</span></code></a> file and <code class="xref doc docutils literal"><span class="pre">import</span> <span class="pre">it</span> <span class="pre">into</span> <span class="pre">App</span> <span class="pre">Inventor</span></code>. The screen will look like this:</p>
<img alt="../_images/farewell-tracy.png" src="../_images/farewell-tracy.png" />
<p>Run the app and see how it displays your phone's IP address near the
top. This is the public address that is used to identify your device on
the Internet. While humans think of locations on the Internet as being
URLs, in reality these URLs are just surrogates for IP addresses.</p>
<p>This project uses a <code class="docutils literal"><span class="pre">Web</span></code> component, which is used to make requests
over the Internet. In this case, a web request is sent to
<code class="docutils literal"><span class="pre">http://ipecho.net/plain</span></code>, and when the response comes back from the
server, it's shown by <code class="docutils literal"><span class="pre">IPAddressLabel</span></code>. Open the above URL in the web
browser on your computer and you'll also see an IP address, although
probably not the same one as your phone's.</p>
<p>Space Cat must have put inordinate value on knowing one's IP address,
but Tracy couldn't care less (although she appreciates the gesture). She
asks if you could replace that part of the screen with something more
interesting. You know that Tracy is a designer, so you decide to show a
design-related quote instead.</p>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p class="last">Delete the label that says &quot;Your IP address&quot;, and rename <code class="docutils literal"><span class="pre">IPAddressLabel</span></code> to <code class="docutils literal"><span class="pre">QuoteLabel</span></code>. Change the blocks in the program so that <code class="docutils literal"><span class="pre">QuoteLabel</span></code> displays the results of this URL: <code class="docutils literal"><span class="pre">http://quotesondesign.com/api/3.0/api-3.0.json</span></code>.</p>
</div>
<p>After making the change, run the app again and you'll see something like
this:</p>
<img alt="../_images/design-quote-json.png" src="../_images/design-quote-json.png" />
<p>What's going on here? View the URL in your browser and you'll see the
same weird-looking text. Unlike the last URL, this URL doesn't return
plain text—it returns
<a class="reference external" href="https://www.google.com/search?q=what+is+json">JSON</a>, a structured
text format. While most URLs are home to web pages, this URL has an
Application Programming Interface (usually shortened to API). An API is
meant to be consumed by an application.</p>
<p>JSON often isn't very readable to humans because it's intended to be
read by machines. A JSON result usually contains multiple items of data.
This is easier to see if we reformat it in a human-readable way:</p>
<div class="code json highlight-python"><div class="highlight"><pre><span class="p">{</span>
  <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="mi">602</span><span class="p">,</span>
  <span class="s">&quot;quote&quot;</span><span class="p">:</span> <span class="s">&quot;Without good design it is easy to miss the point.&quot;</span><span class="p">,</span>
  <span class="s">&quot;author&quot;</span><span class="p">:</span> <span class="s">&quot;Bjarni Wark&quot;</span><span class="p">,</span>
  <span class="s">&quot;permalink&quot;</span><span class="p">:</span> <span class="s">&quot;http:\/\/quotesondesign.com\/?p=602&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You can see that not only does the result contain a quote, it also
contains the author of the quote, as well as some other pieces of data.</p>
<p>If you use the <code class="docutils literal"><span class="pre">Web.JsonTextDecode</span></code> block to parse the above JSON
text, it will yield a list of lists:</p>
<img alt="../_images/list-of-lists1.png" src="../_images/list-of-lists1.png" />
<p>A list of lists is essentially a lookup table. You can read more about
lists of lists in <a class="reference internal" href="../appendix/list-of-lists/index.html"><em>here</em></a>. You can use the
<code class="docutils literal"><span class="pre">look</span> <span class="pre">up</span> <span class="pre">in</span> <span class="pre">pair</span></code> block from the List group to get the value for a
given key. For example, to display just the quote in <code class="docutils literal"><span class="pre">QuoteLabel</span></code>, you
would do something like this:</p>
<img alt="../_images/display-quote.png" src="../_images/display-quote.png" />
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Add a new label beneath <code class="docutils literal"><span class="pre">QuoteLabel</span></code> called <code class="docutils literal"><span class="pre">AuthorLabel</span></code>. Make it so that your app looks like this:</p>
<img alt="../_images/design-is-easy.png" src="../_images/design-is-easy.png" />
<div class="exercise-hint">
<button>Hint</button><div class="hidden hint-body">You will want to use the <code class="docutils literal"><span class="pre">initialize</span> <span class="pre">local</span></code> block to avoid needless redundancy.</div></div><div class="last exercise-hint">
<button>Hint</button><div class="hidden hint-body">To put the dash at the front in <code class="docutils literal"><span class="pre">AuthorLabel</span></code>, use the <code class="docutils literal"><span class="pre">join</span></code> block in the Text group.</div></div></div>
<p>Tracy really enjoys seeing a new design quote every time she opens the
app! However, after a week of using the app, she says she's tired of
seeing Space Cat's mug all the time. &quot;Doesn't the Internet have plenty
of other cat pictures I can look at?&quot; she muses.</p>
<p>You do a little googling, and discover that, of course, there is a cat
image API! The URL for it is
<code class="docutils literal"><span class="pre">http://thecatapi.com/api/images/get?size=small</span></code>. Try visiting that
URL in your browser and see what happens.</p>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Add a Refresh button to the app so that whenever you click it, <code class="docutils literal"><span class="pre">Image1</span></code> will display a random cat image from the Cat API.</p>
<div class="last exercise-hint">
<button>Hint</button><div class="hidden hint-body">You can set <code class="docutils literal"><span class="pre">Image1.Picture</span></code> to the URL of an image.</div></div></div>
<p>Tracy loves being able to view different cat pictures! After a few days,
however, you receive a text from her that says: &quot;Some days I only feel
like seeing photos of cats wearing hats. Other days I only want to see
cats in space. Can you do something about that?&quot;</p>
<p>Fortunately, the Cat API allows you to specify what category of cat
photo you'd like to get. It does so via the query string. The query
string is the part of a URL that comes after the question mark symbol
(?), and contains one or more query string parameters. We are actually
already using a query string parameter named &quot;size&quot;, whose value we've
set to &quot;small&quot;. In the text block that contains the Cat API URL, change the value of &quot;size&quot; to &quot;large&quot;, and see how that change affects the image that is displayed after you click the Refresh button.</p>
<p>Inside the query string, query string parameters are separated by the
ampersand symbol (&amp;). For example:</p>
<p><a class="reference external" href="https://awesome-dinosaurs.com/api/?size=huge&amp;action=chomp&amp;victim=lawyer&amp;accessory=fedora">https://awesome-dinosaurs.com/api/?size=huge&amp;action=chomp&amp;victim=lawyer&amp;accessory=fedora</a></p>
<p>Assuming there really was an API for awesome dinosaur images, the above
URL might be what you'd use to request a picture of a huge,
fedora-wearing dinosaur chomping on a lawyer.</p>
<p>To control the category of the cat photos, you just need to add the
&quot;category&quot; query string to the end, like so:</p>
<p><a class="reference external" href="http://thecatapi.com/api/images/get?size=small&amp;category=hats">http://thecatapi.com/api/images/get?size=small&amp;category=hats</a></p>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Add a <code class="docutils literal"><span class="pre">ListPicker</span></code> to your screen, and add the options Hat, Space, and Clothes to it. Make sure its properties look like <a class="reference download internal" href="../_downloads/catcategorypicker-properties.png"><code class="xref download docutils literal"><span class="pre">this</span></code></a>. Then change your blocks so that whenever you click <code class="docutils literal"><span class="pre">RefreshButton</span></code>, <code class="docutils literal"><span class="pre">Image1</span></code> will show a new image that corresponds to the current category selected in the <code class="docutils literal"><span class="pre">ListPicker</span></code>.</p>
<div class="last exercise-hint">
<button>Hint</button><div class="hidden hint-body">You'll probably want to use the <code class="docutils literal"><span class="pre">join</span></code> block.</div></div></div>
<p>Although assembling the URL by concatenating strings does work in this
case, it's doesn't work well for all query strings. Let's say that there
is an API that allows you to submit your favorite movie quotes so that
they appear on a website. You decide you want to submit a line from <em>Nausicaä of the Valley of the Wind</em>:</p>
<blockquote>
<div>Even the topsoil in our valley is polluted. But… I don't
understand. Who could have polluted the entire earth?</div></blockquote>
<p>So you assemble a URL that looks like this:</p>
<p>
http://film-quotes.com/api/?<span style="color:red">movie</span>=<span style="color:blue;font-weight:bold;">Nausicaä of the Valley of the Wind</span>&amp;<span style="color:red">quote</span>=<span style="color:blue;font-weight:bold;">Even the topsoil is in our valley is polluted. But… I don't understand. Who could have polluted the entire earth?</span></strong>
</p><p>Unfortunately, this is not going to work, because only certain
characters are allowed in URLs, and your quote uses many that aren't
allowed. You have to encode the URL in a special format so that the
server can receive the text properly. When encoded correctly, the URL
should look like this:</p>
<p>
http://film-quotes.com/api/?<span style="color:red">movie</span>=<span style="color:blue;font-weight:bold;">Nausica%C3%A4+of+the+Valley+of+the+Wind</span>&amp;<span style="color:red">quote</span>=<span style="color:blue;font-weight:bold;">Even+the+topsoil+is+in+our+valley+is+polluted.+But%E2%80%A6+I+don%27t+understand.+Who+could+have+polluted+the+entire+earth%3F</span>
</p><p>Fortunately, the <code class="docutils literal"><span class="pre">Web.BuildRequestData</span></code> block can be used to encode
the query string part of your URL. To properly build the URL in the
previous example, you would assemble your blocks like
this:</p>
<img alt="../_images/buildrequestdata.png" src="../_images/buildrequestdata.png" />
<p>Note that <code class="docutils literal"><span class="pre">Web.BuildRequestData</span></code> accepts a list of lists.</p>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p class="last">Change how the URL is assembled so that you're using <code class="docutils literal"><span class="pre">Web1.BuildRequestData</span></code> to create the query string portion of the URL.</p>
</div>
<p>Namaste! In this chapter, you learned about the <code class="docutils literal"><span class="pre">Web</span></code> component, JSON,
APIs, and query strings. You are one step closer to becoming the Guru of
Karma!</p>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../location/index.html" class="btn btn-neutral float-right" title="Location" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../qr-code/index.html" class="btn btn-neutral" title="QR Code" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/jquery.fitvids.js"></script>
      <script type="text/javascript" src="../_static/tutorial.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>